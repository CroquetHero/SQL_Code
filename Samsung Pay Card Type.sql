select payment_type
,count(division_order_id)units
--select *
from
(
select division_order_id
,substr(message,instr(message,'{',1,2)+9,(instr(message,'cardholder_name',1,1)) - (instr(message,'{',1,2)+12))payment_type
,message


from cpg_log

where creation_date > '3/1/2017'
and source_method_name = 'submitRequest'
and logger_name = 'support.cpg.payeezy'
and message like 'Response%'
and param like '%New%'
and payment_method_id = 'Cryptogram'
--and division_order_id in ('14370331871','14292134371','14370024871','14296402371','14364785871','14374146571','14372115071','14261879571','14362613571','14368896771','14379811971','14351197371','14323843771','14373958871','14289218071','14373814671','14273971771','14366707371','14320145471','14277990071','14389926171','14366251871','14355575071','14271038971','14380228271','14369298171','14369603471','14373209271','14328783871','14375109971','14376203471','14390223771','14380639271','14375358971','14375174971','14387173071','14358693671','14320144471','14367794071','14382473871','14375552371','14315553571','14374076471','14371493571','14382358671','14360838371','14377662971','14368468371','14377095271','14392486571','14377856871','14333034771','14314135971','14391874971','14341243071','14388225971','14389037771','14389087571','14357338671','14377462371','14388447171','14386977271','14387163671','14374774071','14388890571','14386651471','14388407771','14388562071','14360380071','14324442971','14386794171','14387689071','14386185971','14351034971','14374324371','14336248671','14372466171','14387656471','14380317671','14336044071','14359682571','14386503971','14372086071','14387183071','14308546571','14389551871','14377017171','14387470171','14337936071','14387859271','14386795871','14377609371','14386334971','14357680371','14390769971','14387558471','14342285371','14335435271','14335223371','14389202471','14370182571','14368190571','14344480771','14375072971','14372308371','14370009771','14379124771','14322969771','14373168471','14376576371','14366457771','14391751371','14367184071','14363021371','14369722271','14372414371','14368925471','14364963671','14364845271','14386301371','14336253671','14366910471','14376229471','14377269471','14322346471','14375085171','14353347671','14389418971','14383765771','14368789971','14344998071','14379211571','14380398871','14364457871','14366996471','14379662971','14308649371','14375457571','14353764871','14304374371','14384581571','14324363871','14384547071','14361575371','14369394171','14349030671','14383350471','14309027271','14339410771','14366768871','14307281771','14382160571','14302326171','14372002671','14316256071','14361981771','14376642771','14367681771','14301134271','14367460371','14376733871','14388699271','14310274771','14379681571','14335493371','14391139071','14374234571','14370955271','14304436871','14373424771','14394523371','14379801371','14308466971','14369702071','14304445171','14320181071','14379447871','14371011371','14370433771','14369166171','14358555071','14345752571','14391160771','14379781171','14367034371','14307452071','14315597571','14395555771','14373975871','14366565071','14373124271','14371712571','14370529871','14364832171','14306201971','14389551571','14367004071','14368164471','14364969571','14367344871','14386183971','14350514371','14367145171','14335950371','14373483471','14370582771','14371729971','14367154471','14358898071','14392199871','14318878071','14352839671','14321365071','14280574271','14367442071','14338735471','14395664471','14387360971','14368688271','14368011971','14344793671','14302983771','14332889471','14338482371','14373178271','14390476571','14320489171','14309494971','14370279571','14391409571','14382182271','14372220871','14356339271','14315300171','14372137971','14381501471','14385114871','14276884871','14360421371','14377328871','14336961871','14323975771','14377273071','14392681471','14385404271','14380264971','14379582371','14381874071','14362131471','14377215471','14378036471','14358402671','14391223071','14320374171','14372584471','14368539271','14371800171','14372581371','14377169071','14377271471','14380077071','14343527171','14317557271','14377024671','14318179071','14386225671','14362457571','14362492071','14390945871','14377085171','14339477671','14383473271','14372552471','14373008771','14330212371','14329911071','14277347471','14363848471','14372594071','14339487871','14386160071','14366232971','14310004471','14366819271','14385325571','14391062471','14339461371','14374111171','14390651371','14390837871','14367554171','14388816371','14375533671','14387121971','14333414971','14366372771','14383162871','14391770971','14377618671','14367336871','14373677271','14369341971','14376168471','14372228471','14368864671','14355759171','14376845971','14365028271','14375162671','14379922771','14384521171','14367598771','14361025571','14285711171','14325658871','14367506571','14326166171','14381971071','14360527071','14361084871','14369925171','14368857971','14366279071','14316674271','14370686671','14370780571','14395841871','14383200071','14391334971','14347626271','14375074071','14318082271','14368533371','14394031171')

)

--where payment_type is null

group by payment_type

order by units desc